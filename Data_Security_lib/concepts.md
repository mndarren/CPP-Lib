# Basic Client/Server Security & Data Security Concepts (Debian)
================================================================  
0. Linux Family Classification
   ```
   Server and Corporative: RedHat, SuSe, Fedora, CentOS
   Education and home: Ubuntu, Debian
   Pen and Security: Kali, Onion
   ```
1. Socket: `net.node.port`
2. Packet: Five layers 
   ```
   layer 1 (physical layer)
   layer 2 (link layer) (Ethernet/Frame Header): 14 B
   layer 3 (network layer)   (IP Header): 20 B
   layer 4 (transport layer)  (TCP/UDP/ICMP Header) xx/8/8 B
   layer 5 (data/payload layer)
   ```
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/packet_layers.PNG)
3. IP 5 classes
   ```
   class A: 1-127 (N.H.H.H) (127.0.0.0/8 for loopback)
   class B: 128-191 (N.N.H.H)
   class C: 192-223 (N.N.N.H)
   class D: 224-239 (Reserved for Multicasting)
   class E: 240-254 (Experimental/used for research)
   ```
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/IP_classes.PNG)
4. Private IP addresses
   ```
   class A: 10.0.0.0/8
   class B: 172.16.0.0/16 -> 172.31.0.0/16
   class C: 192.168.0.0/16
   ```
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/private_IP.PNG)
5. Headers structure  
   IP header:  
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/IP_header.PNG)
   TCP header:  
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/TCP_header.PNG)
   UDP header:  
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/UDP_header.PNG)
   ICMP header:  
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/ICMP_header.PNG)
6. Linux structure
   Kernel -> Module -> Daemon -> Applications  
   ![alt text](https://github.com/mndarren/Code-Lib/blob/master/Data_Security_lib/resource/pic/Linux_structure.PNG)
7. /usr/sbin: Unix System Resources/System binary
8. TCP flags
   ```
   U -URG --Urgent       ---Unskilled
   A -ACK --Ackownlege   ---Attacker
   P -PSH --Push         ---Pester
   R -RST --Reset        ---Real
   S -SYN --Synchronize  ---Security
   F -FIN --Final        ---Folks
   ```
9. Important config files
   ```
   /etc/fstab     # accessible fs
   /etc/motd      # message of today
   /etc/hosts     # names to ip addresses
   /etc/networks  # network names to ip addresses
   /etc/protocols # contain all protocols
   /etc/services  # contain all services
   /etc/pid#/maps # view process in memory (rwsp, read|write|shared|protected)
   ```
10. Port types
   ```
   encrypted port (Ex: 22)
   redirected port (Ex: ncat -v -c 'echo this is a test' -l -p 1234 -t)
   status port (Ex: rpcinfo -p 10.18.59.34)
   rogue port (Ex: you don't know)
   ```
11. Digital Signature (used to confirm Data Integration)
   ```
   Type    |  Hex  |  bits
   sum        5       20
   cksum      10      40
   md5sum     32      128
   sha128sum  32      128
   sha512sum  124     512
   ```
12. Top 20 ports
   ```
   Echo        7         TCP/UDP
   FTP         20/21     TCP
   SFTP        115       TCP      --encrypted
   FTPS        989/990   TCP      --encrypted
   SSH/SCP     22        TCP      --encrypted
   Telnet      23        TCP
   SMTP        25        TCP      --used for sending email
   SMTPS       465       TCP      --encrypted
   POP3        110       TCP      --used for receiving email
   POP3S       995       TCP      --encrypted
   DNS         53        TCP
   DHCP        67/68     UDP
   HTTP        80        TCP
   HTTPS       443       TCP      --encrypted
   Kerberos    88        TCP/UDP  --464 for Kerberos v5
   sunrpc      111   
   SNMP        161/162
   LDAP        389   
   LDAPS       636       TCP/UDP  --encrypted
   NFS         2049
   Protected   0-1023
   ```   
13. Terms
   ```
   MAC  --Media Access Control
   LLC  --Logical Link Control
   DNS  --Domain Name System
   TCP  --Transission Control Protocol (6)
   UDP  --User Datagram Protocol (17)
   ICMP --Internet Control Message Protocol (1)
   ARP  --Address Resolution Protocol
   LDAP --Lightweight Directory Access Protocol
   DHCP --Dynamic Host Configuration Protocol
   HTTP --Hypertext Transfer Protocol
   SNMP --Simple Network Management Protocol
   CSMA/CD --Carrier Sensor Multiple Access/Collision Detection
   UUCP --Unix to Unix Copy Protocol
   UUID --Universally Unique Identifiers
   SSL  --Security Socket Layer
   NAS  --Network Attached Storage
   RAID --Redundant Array of Independant Disks
   MBR  --Master Boot Record
   VBR  --Volume Boot Record
   Nyble--4 bits, half byte, nibble, nybble
   PTR  --Public Test Region, used to reverse IP addr
   VPN  --Virtual Private Network (double encrypted)
   PID  --a chunk of code in memory
   OSPF --Open Shortest Path First
   XID  --Transaction ID, generated by transactionn manager
   NUMA --Non-Uniform Memory Access
   AS   --Autonomous System (multiple computers, multiple domains, multiple clouds)
   VLAN --Virtual Local Area Network
   VT   --Virtualization Technology
   ```
14. 7 file types
   ```
   -  --file
   d  --directory
   p  --pipe
   c  --character
   l  --link
   b  --block
   s  --socket
   ```
15. TTL default length
   ```
   64   --Linux default
   128  --Windows default
   255  --Cisco default
   ```
16. Diff between Reject connection and Drop connection   
   ```
   1) Deny(Reject,sending an ICMP destination-unreachable back): close server  
      -> client tried to connect server -> kernel reply refused for safety
   2) Drop: (prohibit a packet from passing. send no response)
   Create a new chain:
   iptables -N LOG_AND_DROP
   iptables -A LOG_AND_DROP -j LOG --log-prefix "Source host denied "
   iptables -A LOG_AND_DROP -j DROP
   Use this chain:
   iptables -A INPUT -s z.z.z.z/32 -j LOG_AND_DROP
   iptables -A INPUT -s y.y.y.y/32 -j LOG_AND_DROP
   iptables -A INPUT -s a.a.a.a/32 -j LOG_AND_DROP
   Note: Make sure you flush existing rules before adding the above rules.  
   Otherwise you'll still have the misleading rule in there that is logging but not denying.
   ```
17. **English Domain** --(DNS)--> **Number IP address** --(ARP)--> **Data Link(MAC)**
18. Stateful Inspection (See details for Ramdisk in Big_Tools.md)<br/>
   ```
   It's not so respectful because:  
   1) 75% attacks coming at Application level
   2) encryption will not detect the attacks
   ```
19. AS (Autonomous System)  --cloud zones #**Virtual zone environment**
20. Timing Vectors<br/>
    Why do we need it? Because:
    Attacker monitor our port traffic, and use it to spoof us to connect their bogus host.  
    Then they can get our username and password. Timing Vectors can detect such attacks.
21. Etag/Cookies<br/>
    Etag, or Entity tag, is part of HTTP, used for web cache validation.  
    Web server does not need to send a full response if content no change.
    Cookies,or HTTP cookie, web cookie, browser cookie, contains state information  
    from server sending. Used for anthentication, confirmation of user session.  
    **Hacker wants to get your cookie data**
22. Vulnerable Services<br/>
    1) UUCP is one of the most dangerous because unencrypted and poor authentication method.  
       **Never use unencrypted ports**
    2) **ports not defined in /etc/services should be defined in /etc/service.local**
    3) All services within (netstat -a) should be monitored and undocumented services  
       should be disable. **Hacker likes bogus ports**
23. Client/Server Architecture<br/>
    1) **Perform everything possible on the client side** because it'll improve performance,  
       reduce network traffic, reduce network stream compromised.
    2) **TCP over UDP for more secure**
    3) **if complexity is greater than three, make sure each network link is protected**
24. Pseudo terminal process id<br/>
    `$ps -aux | grep dguster`   # output pts/0 pts/2 mean pseudo terminal
25. Hard character (can be printed out) and Soft character (first 32 non-printing characters)
26. Swap --part of disk as memory
27. Character device (Memory), Block device (disk)
28. sda1 --system drive, physical disk a, logical partition 1
29. 3 levels access rights
   ```
   1) kernel level
   2) root level
   3) user level
   ```
30. 3 data locations
   ```
   1) network (most dangerous) #local, fiber, Ethernet, loopback. tcpdump
   2) memory   #cache, shared buffer. dd, xxd
   3) disk     #xxd
   ```
31. layered security
   ```
   1) cloud -> zone -> host
   2) fs -> dir -> file
   ```
32. file formats
   ```
   1) binary format  #faster, encapsulated, encrypted binary
   2) ASCII format
   3) EBCDIC format
   ```
33. Primary data
   ```
   #Hackers really wants
   #Hexdecimal numbers
   #Example: www.sun.com (no), 156.151.59.36 (yes)
   ```
34. CIA (Confidentiality, Integrity, availability)
   ```
   CI: positive relation
   CA: negative relation
   IA: negative relation
   ```
35. 2 tasks of process
   ```
   1) copy data
   2) calculate data
   ```
36. IO   and  NIO  in  java lib
   ```
   IO: stream oriented, blocking IO
   NIO: buffered oriented, Non-blocking IO, Selectors
   Buffered oriented: check if buffer contains all data you need;  
                      make sure not to overwrite data you have not processed
   Blocking IO: when a thread invoke read() or write(),  
                the thread is blocked until finished read or write
   Non-blocking IO: thread can do other things even if not finish r or w
   Selectors: a thread can monitor multiple channels
   ```
37. Kerberos and LDAP
   ```
   Kerberos --a network authentication protocol, created by MIT.  
              Protected from against eavesdropping and replay attacks
   Ldap is used to holding authoritative information about accounts;
   Kerberos is used to manage credentials securely.
   ```
38. Java primitive Data type size
   ```
   boolean: default (false), 1 bit
   char:    default (\u0000), Unicode character, 2 Bytes
   byte:    default (0),   1 B
   short:   default (0),   2 B
   int:     default (0),   4 B
   long:    default (0),   8 B
   float:   default (0.0), 4 B
   double:  default (0.0), 8 B
   ```
39. Compression via RLE (run length encoding)
   ```
   013011 = a string of 17 0's and reduction 14 bytes (17 - 3)
   01452b = a string of 43 E's and reduction 40 bytes (43 - 3)
   01: means rle
   45: E
   2b: nubmer of E
   ```
40. Laws
   ```
   Murphy's Law:"Anything that can go wrong will go wrong!"
   Linus's Law:"Given enough eyeballs, all bugs are shallow!"
   Miller's Law:"At any time, we can concerntrat on only approximately seven chunks!"
   Brooks's Law:"Adding personel to a late software project makes it then later!"
   Guster:"We cannot stop hacker, but can slow them down!"
   Guster:"The most robust is the use of file hashes!"
   ```
41. output of time command
   ```
   real time: cpu time + waiting time
   user time: application time
   sys  time: cpu time
   ```
42. Authenticate cloud: better. eros uses authentication cloud  
    Authenticate host
43. Cannot see user name in /etc/passwd, but still can login. Why?  
    Login cloud, not host.
44. Off dc1.bcrl.local and dc2.bcrl.local, but user still can login. Why?  
    Because of cache containing user info, so Hacker likes cache.
45. Finger print: after sum, cksum, md5sum, sha256sum, sha512sum signature file => finger print
46. Timestamps of `$stat filename`
    ```
    Access - the last time the file was read
    Modify - the last time the file was modified (content has been modified)
    Change - the last time meta data of the file was changed (e.g. permission)
    ```
47. About fork()
   ```
   # child process will share all the segments like text, stack, heap etc when initialization.
   # In case of any change of child, a separate copy of stack and heap segments are prepared for child.
   # The text segment is read-only so both parent and child share the same text segment.
   # Linux kernel views thread as process. Linux supports threads at user level only.
   ```
48. Linux Threads vs Light Weight Processes
   ```
   # Threads in Linux are nothing but a flow of execution of the process.  
     A process containing multiple execution flows is known as multi-threaded process.
   # The main difference between LWP and normal process is   
     that LWPs share same address space and other resources like open files etc.
   ```
49. The relationship between Thread, Process, process group, session    
   ```
   A session contains a number of process group,  
   A process group contains a number of process,  
   A process contains a number of threads.  
   ```
50. Floating point (Sign + exponent + mantissa)
   ```
   2^0    = 1,   --0111 1111 (127 exponent bits)
   2^1    = 2,   --1000 0000 (128)
   2^(-1) = 1/2, --0111 1110 (126)
   float:  1 + 8  + 23 = 32 bits
   double: 1 + 11 + 52 = 64 bits
   float:  1 = 3F 80 00 00
   double: 1 = 3F F0 00 00 00 00 00 00
   float:  2 = 40 00 00 00
   double: 2 = 40 00 00 00 00 00 00 00
   float:  3 = 40 40 00 00
   double: 3 = 40 08 00 00 00 00 00 00
   ```
51. Target Acquisition
   ```
   #Target acquisition typically the first step of the types of common external threats.
   #It's the detection, identification, and location of a target in sufficient detail
   to permit the effective employment of lethal and non-lethal means.
   ```
52. Cloud zone
   ```
   Cloud zone refers to splitting a network cloud into different partitions via netmask and gateway.
   For example, for a network 199.17.59.x/24, there are 199.17.59.1 – 199.17.59.254
   IP addresses that we can use. If mask = 255.255.255.0, they are in the same group.
   When we use netmask 255.255.255.192, the cloud actually was separated into 4 zones 
   (199.17.59.1-63, 199.17.59.64-127, 199.17.59.128-191, 199.17.59.192-254)
   because this mask means our network becomes 199.17.59.x/26. That is, in x part, 
   there are first 2 bits fixed and these 2 bits can be (00,01,10 and 11) which makes 4 zones.
   ```
53. Sticky wicket
   ```
   There are other flags besides rwx, one of the most useful is the sticky bit which can be
   used in directories to prevent deletion of that directory and its content by other users
   even though they have write permissions on the directory contents.
   This limits delete rights to only the owner and the root. Sticky bits can be set either
   symbolically or numerically.
   $chmod o+t ~/stickydir
   $chmod 1754 ./stickydir
   ```
54. How is Linux more secure than Windows
   ```
   1) Each file has permission. Even if a use runs a malicious program, that program inherits 
      the user's permissions, and so cannot do anything that the user themselves could not do.
   2) Each file has the system's file type identifier embedded in the file itself instead of 
      relying on an extension. So one cannot fool system with it.
   3) outside processes are treated as public processes, so a web page with a malicious executable
      program embedded in it cannot affect the use's files without permission.
   ```
55. `sm-notify` A helper program that notifies NFS peers after the local system reboots.  
    `rpc.statd` The local NFS lock manager alerts its local `rpc.statd` of each remote peer that should  
                be monitored. When the local system reboots, the `sm-notify` command nitifies   
                the NSMservice on monitored peers of the reboot. When a remote reboots, that peer  
                notifies the local `rpc.statd`, which in turn passes the reboot notification back  
                to the local NFS lock manager.  
    For each NFS client or server machine to be monitored, `rpc.statd` creates a file /var/lib/nfs/sm.  
    If transport encapsulation is enabled, Encapsulation is alive and well  
    `TCP_WRAPPERS SUPPORT` This `rpc.statd` version is protected by the tcp_wrapper library. You have to  
                           give the client access to `rpc.statd` if they should be allowed to use it.  
                           To allow connects from clients of the .bar.com domain you could use the line  
                           in /etc/hosts.allow:  statd: .bar.com  
56. Runlevels (Level & purpose) the init program reads the /etc/inittab file to determine the behavior for each runlevel when booting
   ```
   0 -> Halt                            --shut down system
   1 -> Single-user mode                --without networking, start daemons, or allow non-root logins (usually aliased as s or S)
   6 -> Reboot                          --Reboot the system
   2 -> Multi-user mode                 --without networking or start daemons
   3 -> Multi-user mode with networking --starts the system normally
   5 -> X11 mode                        --runlevel 3 and the X Window System
   4 -> Undefined                       --Not used/User-definable
   ```
57. 9 servers architecture
   ```
   1) Time Server, VM host (running Linux)
   2) Main Client Access Server. SSH login (Firewall will forward all port22 traffic to this partition)
   3) Secondary Client Access Server.(as backup if partition 1 locks up, Firewall forward alternate port to this)
   4) Global Authentication Server (OpenLDAP/Kerberos5-MIT)
   5) Network Address Resolution Server (DNS/DHCP/LDAP)
   6) E-Mail Server (Linux mail server installed)
   7) Global File System Server for Home Folders (NFS Mounted)
   8) Programming Application Development Server (java, C, C++ and etc.)
   9) Data-Base Application Server (MySQL, SQL queries, DB tuning and etc.)
   ```
58. qubit: a unit of quantum information (0, 1, 0&1)
   ```
   Quantum mechanism allows the qubit to be in superposition of both states at the same time, a property that's
   fundamental to quantum computing.
   Quantum computers exploit two phenomena --entanglement and superposition-- to process information differently 
   ```
59. Centralized logging
   ```
   1) It helps protect resources;
   2) It provides data that can be used to ensure individual accountability
   3) it providesa single collection point in distributed systems
   4) By exporting logs to a centralized location it is more difficult for hackers to cover their tracks
   5) It will generate vast amounts of data so an effective management strategy is required
   6) Computer resources are limited and must be protected from both internal and external abuse
      Internal threat causes more damage, and internal problems may not be intentional
   7) Because of distributed resources logging should be centralized and still provide pointers to applications and devices
   8) Granularity must be considered to limit the volume of data recorded (by means of audit reduction tools)
   ```
60. Container (a mechanism to store data)
   ```
   Access: indexed, LIFO, FIFO
   Search: sequential file or random file
   Size: static or dynamic (array or ArrayList/Vector), logical size or physical size
   Action: create, report size, insert, remove, delete, access
   Content: values or reference (link or not)
   Type: ASCII, EBCDIC, others
   ```
61. Difference between Java Pipe and Linux Pipe
   ```
   Java Pipe is used to communicate between 2 threads running in the same JVM, not work between different JVM (different process).
   Linux Pipe can be used to communicate in different address spaces.
   ```
62. Delay
   ```
   1) Given that the network delay on the Internet in the US might often take .5 seconds in each direction,
      it's important to optimize each of the parameters.
   2) This whole algorithm is based on queuing theory, which means that there is an ineraction
      among all the parameters.
   3) a delay of .0005 instead of .0001 at the first parameter won't result .0004 seconds of additional
      response time. Rather, it'll propagate through the entire algorithm and the delay will get a little
      longer with added wait time at each successive parameter. (say 12 parameters, will wholy delay .8192)
   ```
63. java.io.ObjectStreamConstants Hex values
   ```
    final static short STREAM_MAGIC = (short)0xaced;
    final static short STREAM_VERSION = 5;
    final static byte TC_BASE = 0x70;
    final static byte TC_NULL =         (byte)0x70;
    final static byte TC_REFERENCE =    (byte)0x71;
    final static byte TC_CLASSDESC =    (byte)0x72;
    final static byte TC_OBJECT =       (byte)0x73;
    final static byte TC_STRING =       (byte)0x74;
    final static byte TC_ARRAY =        (byte)0x75;
    final static byte TC_CLASS =        (byte)0x76;
    final static byte TC_BLOCKDATA =    (byte)0x77;
    final static byte TC_ENDBLOCKDATA = (byte)0x78;
    final static byte TC_RESET =        (byte)0x79;
    final static byte TC_BLOCKDATALONG= (byte)0x7A;
    final static byte TC_EXCEPTION =    (byte)0x7B;
    final static byte TC_LONGSTRING =   (byte)0x7C;
    final static byte TC_PROXYCLASSDESC=(byte)0x7D;
    final static byte TC_ENUM =         (byte)0x7E;
    final static byte TC_MAX =          (byte)0x7E;
    final static int baseWireHandle = 0x7e0000;
         **Bit masks for ObjectStreamClass flag.**
    final static byte SC_WRITE_METHOD = 0x01;
    final static byte SC_BLOCK_DATA = 0x08;
    final static byte SC_SERIALIZABLE = 0x02;
    final static byte SC_EXTERNALIZABLE = 0x04;
    final static byte SC_ENUM = 0x10;
   ```